<!DOCTYPE html>
<html>
<head>
  <title>View All News</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link rel="stylesheet" href="ViewByCategory.css">
  <link rel="stylesheet" href="UpdateNews.css">
</head>
<body>
  <h1 id="Title">View All News</h1>
  <hr class="style13">
  <div id="results"></div>
  
  <h1 id="UpdateTitle">Update News</h1>
  <hr class="style13">
  <div class="formDIV">
    <form id="updateForm" method="POST" action="UpdateNews.php">
      <label for="Title">Title:</label>
      <br>
      <input type="text" id="updateTitle" name="Title" required>
      <br>
      <br>
      <label for="Producer">Producer:</label>
      <br>
      <input type="text" id="updateProducer" name="Producer" required>
      <br>
      <br>
      <label for="Text">Text:</label>
      <br>
      <textarea id="updateText" name="Text" required></textarea>
      <br>
      <br>
      <label for="Date">Date:</label>
      <br>
      <input type="date" id="updateDate" name="Date" required>
      <br>
      <br>
      <label for="Category">Category:</label>
      <br>
      <input type="text" id="updateCategory" name="Category" required>
      <br>
      <br>
      <input type="submit" value="Update News" class="myButton" onclick="return confirm('Are you sure you want to update this news?')">
    </form>
  </div>
  
  <hr class="style13">
  <div class="navbar">
    <a href="login.html">Login</a>
    <a href="AddNews.html">Add News</a>
    <a href="ViewAll.html">Update News</a>
    <a href="ViewByDate.html">View News by Date</a>
    <a href="ViewByCategory.html">View News by Category</a>
  </div>
  
  <script>
    $(function() {
      $.ajax({
        type: 'GET',
        url: 'ViewAll.php',
        dataType: 'json',
        success: function(data) {
          // Build the table to display the news results
          var table = '<table>';
          table += '<tr><th>Title</th><th>Producer</th><th>Text</th><th>Date</th><th>Category</th></tr>';
          $.each(data, function(index, entry) {
            table += '<tr class="result-row" data-entry-title="' + entry.title + '">';
            table += '<td>' + entry.title + '</td>';
            table += '<td>' + entry.producer + '</td>';
            table += '<td>' + entry.text + '</td>';
            table += '<td>' + entry.date + '</td>';
            table += '<td>' + entry.category + '</td>';
            table += '</tr>';
          });
          table += '</table>';
          $('#results').html(table);
        },
        error: function(xhr, status, error) {
          console.log("Error: " + error.message);
          $('#results').html('Error retrieving data: ' + error.message);
        }
      });

      // Make table rows clickable
      $(document).on('click', '.result-row', function() {
        // Get the entry data from the clicked row
        var entryTitle = $(this).data('entry-title');
        var entryProducer = $(this).find('td:eq(1)').text();
        var entryText = $(this).find('td:eq(2)').text();
        var entryDate = $(this).find('td:eq(3)').text();
        var entryCategory = $(this).find('td:eq(4)').text();

        // Set the values in the update form
        $('#updateTitle').val(entryTitle);
        $('#updateProducer').val(entryProducer);
        $('#updateText').val(entryText);
        $('#updateDate').val(entryDate);
        $('#updateCategory').val(entryCategory);
      });
    });
  </script>
</body>
</html>
